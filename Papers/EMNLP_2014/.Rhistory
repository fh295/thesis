library(ggplot2)
df1 <- read.table('Graph_1_data2.txt', header =T)
df3 <- read.table('Graph_1_data3.txt', header =T)
h<- 1.61
plot1 <- ggplot(data=df1, aes(x=factor(input_source,levels=c("CSLB","ESP","both"),ordered=TRUE), y=correlation, fill=factor(propagation_method,levels=c("concat","CCA","NN"),ordered=TRUE)))+ geom_bar(stat="identity", position=position_dodge(width=0.8), colour="black", width=0.8)+ylab("Correlation")+xlab("Concrete nouns - information combination")+ scale_fill_manual(values=c("indianred3", "goldenrod2","blue3"), labels=c("Vector Concatenation", "CCA",expression(paste("Percep2Vec (",alpha,"=1)"))))+labs(fill="Combination Method") + scale_x_discrete(breaks=c("CSLB","ESP","both"), labels=c("CSLB", "ESP","CSLB & ESP"))+ theme(legend.position=c(0.25,0.87),legend.key.height=unit(3,"mm"), legend.text=element_text(size=8),legend.title=element_text(size=8),axis.text.x = element_text(colour = "black"), axis.text.y = element_text(colour = "black"),axis.title.x = element_text(colour = "black"),axis.title.y = element_text(colour = "#666666")) +coord_cartesian(ylim=c(0,0.4))+geom_hline(yintercept=0.124)+ geom_hline(aes(yintercept=h),linetype="dashed")+ geom_text(aes(0,h,label = "language-only baseline", vjust = -1))
